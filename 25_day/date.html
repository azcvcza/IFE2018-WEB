<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Learning date</title>
</head>

<body>
    <div class="first">
        <p id="date">date1 </p>
        <p id="date2">date2 </p>
    </div>
    <div class="second">
        <select id="year-select">
            <option value="2000">2000</option>
            <option value="2001">2001</option>
            <option value="2002">2002</option>
            <option value="2003">2003</option>
            <option value="2004">2004</option>
            <option value="2005">2005</option>
            <option value="2006">2006</option>
            <option value="2007">2007</option>
            <option value="2008">2008</option>
            <option value="2009">2009</option>
            <option value="2010">2010</option>
            <option value="2011">2011</option>
            <option value="2012">2012</option>
            <option value="2013">2013</option>
            <option value="2014">2014</option>
            <option value="2015">2015</option>
            <option value="2016">2016</option>
            <option value="2017">2017</option>
            <option value="2018">2018</option>
            <option value="2019">2019</option>
            <option value="2020">2020</option>
            <option value="2021">2021</option>
            <option value="2022">2022</option>
            <option value="2023">2023</option>
            <option value="2024">2024</option>
            <option value="2025">2025</option>
            <option value="2026">2026</option>
            <option value="2027">2027</option>
            <option value="2028">2028</option>
            <option value="2029">2029</option>
            <option value="2030">2030</option>
            <option value="2031">2031</option>
            <option value="2032">2032</option>
            <option value="2033">2033</option>
            <option value="2034">2034</option>
            <option value="2035">2035</option>
            <option value="2036">2036</option>
            <option value="2037">2037</option>
            <option value="2038">2038</option>
            <option value="2039">2039</option>
            <option value="2040">2040</option>
            <option value="2041">2041</option>
            <option value="2042">2042</option>
            <option value="2043">2043</option>
            <option value="2044">2044</option>
            <option value="2045">2045</option>
            <option value="2046">2046</option>
            <option value="2047">2047</option>
            <option value="2048">2048</option>
            <option value="2049">2049</option>
            <option value="2050">2050</option>
            <option value="2051">2051</option>
            <option value="2052">2052</option>
            <option value="2053">2053</option>
            <option value="2054">2054</option>
            <option value="2055">2055</option>
            <option value="2056">2056</option>
            <option value="2057">2057</option>
            <option value="2058">2058</option>
            <option value="2059">2059</option>
            <option value="2060">2060</option>
            <option value="2061">2061</option>
            <option value="2062">2062</option>
            <option value="2063">2063</option>
            <option value="2064">2064</option>
            <option value="2065">2065</option>
            <option value="2066">2066</option>
            <option value="2067">2067</option>
            <option value="2068">2068</option>
            <option value="2069">2069</option>
            <option value="2070">2070</option>
            <option value="2071">2071</option>
            <option value="2072">2072</option>
            <option value="2073">2073</option>
            <option value="2074">2074</option>
            <option value="2075">2075</option>
            <option value="2076">2076</option>
            <option value="2077">2077</option>
            <option value="2078">2078</option>
            <option value="2079">2079</option>
            <option value="2080">2080</option>
            <option value="2081">2081</option>
            <option value="2082">2082</option>
            <option value="2083">2083</option>
            <option value="2084">2084</option>
            <option value="2085">2085</option>
            <option value="2086">2086</option>
            <option value="2087">2087</option>
            <option value="2088">2088</option>
            <option value="2089">2089</option>
            <option value="2090">2090</option>
            <option value="2091">2091</option>
            <option value="2092">2092</option>
            <option value="2093">2093</option>
            <option value="2094">2094</option>
            <option value="2095">2095</option>
            <option value="2096">2096</option>
            <option value="2097">2097</option>
            <option value="2098">2098</option>
            <option value="2099">2099</option>
            <option value="2100">2100</option>
            <option value="2101">2101</option>
            <option value="2102">2102</option>
            <option value="2103">2103</option>
            <option value="2104">2104</option>
            <option value="2105">2105</option>
            <option value="2106">2106</option>
            <option value="2107">2107</option>
            <option value="2108">2108</option>
            <option value="2109">2109</option>
            <option value="2110">2110</option>
            <option value="2111">2111</option>
            <option value="2112">2112</option>
            <option value="2113">2113</option>
            <option value="2114">2114</option>
            <option value="2115">2115</option>
            <option value="2116">2116</option>
            <option value="2117">2117</option>
            <option value="2118">2118</option>


        </select>

        <select id="month-select">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
            <option value="11">11</option>

            <option value="12">12</option>
        </select>

        <select id="day-select">
            <option value="00">00</option>
        </select>

        <select id="hour-select">
            <option value="00">00</option>
            <option value="01">01</option>
            <option value="02">02</option>
            <option value="03">03</option>
            <option value="04">04</option>
            <option value="05">05</option>
            <option value="06">06</option>
            <option value="07">07</option>
            <option value="08">08</option>
            <option value="09">09</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
            <option value="13">13</option>
            <option value="14">14</option>
            <option value="15">15</option>
            <option value="16">16</option>
            <option value="17">17</option>
            <option value="18">18</option>
            <option value="19">19</option>
            <option value="20">20</option>
            <option value="21">21</option>
            <option value="22">22</option>
            <option value="23">23</option>
        </select>

        <select id="minite-select">
            <option value="00">00</option>
            <option value="01">01</option>
            <option value="02">02</option>
            <option value="03">03</option>
            <option value="04">04</option>
            <option value="05">05</option>
            <option value="06">06</option>
            <option value="07">07</option>
            <option value="08">08</option>
            <option value="09">09</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
            <option value="13">13</option>
            <option value="14">14</option>
            <option value="15">15</option>
            <option value="16">16</option>
            <option value="17">17</option>
            <option value="18">18</option>
            <option value="19">19</option>
            <option value="20">20</option>
            <option value="21">21</option>
            <option value="22">22</option>
            <option value="23">23</option>
            <option value="24">24</option>
            <option value="25">25</option>
            <option value="26">26</option>
            <option value="27">27</option>
            <option value="28">28</option>
            <option value="29">29</option>
            <option value="30">30</option>
            <option value="31">31</option>
            <option value="32">32</option>
            <option value="33">33</option>
            <option value="34">34</option>
            <option value="35">35</option>
            <option value="36">36</option>
            <option value="37">37</option>
            <option value="38">38</option>
            <option value="39">39</option>
            <option value="40">40</option>
            <option value="41">41</option>
            <option value="42">42</option>
            <option value="43">43</option>
            <option value="44">44</option>
            <option value="45">45</option>
            <option value="46">46</option>
            <option value="47">47</option>
            <option value="48">48</option>
            <option value="49">49</option>
            <option value="50">50</option>
            <option value="51">51</option>
            <option value="52">52</option>
            <option value="53">53</option>
            <option value="54">54</option>
            <option value="55">55</option>
            <option value="56">56</option>
            <option value="57">57</option>
            <option value="58">58</option>
            <option value="59">59</option>
        </select>

        <select id="second-select">
            <option value="00">00</option>
            <option value="01">01</option>
            <option value="02">02</option>
            <option value="03">03</option>
            <option value="04">04</option>
            <option value="05">05</option>
            <option value="06">06</option>
            <option value="07">07</option>
            <option value="08">08</option>
            <option value="09">09</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
            <option value="13">13</option>
            <option value="14">14</option>
            <option value="15">15</option>
            <option value="16">16</option>
            <option value="17">17</option>
            <option value="18">18</option>
            <option value="19">19</option>
            <option value="20">20</option>
            <option value="21">21</option>
            <option value="22">22</option>
            <option value="23">23</option>
            <option value="24">24</option>
            <option value="25">25</option>
            <option value="26">26</option>
            <option value="27">27</option>
            <option value="28">28</option>
            <option value="29">29</option>
            <option value="30">30</option>
            <option value="31">31</option>
            <option value="32">32</option>
            <option value="33">33</option>
            <option value="34">34</option>
            <option value="35">35</option>
            <option value="36">36</option>
            <option value="37">37</option>
            <option value="38">38</option>
            <option value="39">39</option>
            <option value="40">40</option>
            <option value="41">41</option>
            <option value="42">42</option>
            <option value="43">43</option>
            <option value="44">44</option>
            <option value="45">45</option>
            <option value="46">46</option>
            <option value="47">47</option>
            <option value="48">48</option>
            <option value="49">49</option>
            <option value="50">50</option>
            <option value="51">51</option>
            <option value="52">52</option>
            <option value="53">53</option>
            <option value="54">54</option>
            <option value="55">55</option>
            <option value="56">56</option>
            <option value="57">57</option>
            <option value="58">58</option>
            <option value="59">59</option>
        </select>

        <p id="result-wrapper">现在距离 2001年1月1日星期X HH:MM:SS 还有 X 天 X 小时 X 分 X 秒</p>
    </div>
    <button id="stop">停止计时</button>

</body>
<script>
    //second mission: to make a stable function
    //dom select
    var stop = document.getElementById("stop");
    var g_year = document.getElementById("year-select");
    var g_month = document.getElementById("month-select");
    var g_day = document.getElementById("day-select");

    var days_num = {
        1: 31,
        2: 28,
        3: 31,
        4: 30,
        5: 31,
        6: 30,
        7: 31,
        8: 31,
        9: 30,
        10: 31,
        11: 30,
        12: 31,

    };

    //function area
    window.onload = function () {
        //定时器每秒调用一次fnDate()

        var timer = setInterval(function () {
            //determine_days()
            var result = fnDate();
            minus_Date(result);
        }, 1000);
        stop.addEventListener("click", function () {
            clearInterval(timer)
        });
        g_month.addEventListener("change", function () {
            var s_day_length = g_day.options.length;
            for (var k in g_day) {
                g_day.remove(g_day[k]);
            }
            d_year = g_year.value;
            d_month = g_month.value;
            var if_2_29;

            //console.log(g_year.value, g_month.value,(d_year % 4 == 0 && d_year % 100 != 0) || (d_year % 400) == 0,days_num[2]);
            if ((d_year % 4 == 0 && d_year % 100 != 0) || (d_year % 400) == 0) {
                if_2_29 = true;
                days_num[2] = 29;
                //console.log("after change",days_num[2])
            } else {
                if_2_29 = false;
                days_num[2] = 28;
            }
            var i = 1;
            //console.log("before creating",days_num[2])
            var len = days_num[d_month];
            for (i; i <= len; i++) {

                var opt = document.createElement("OPTION");
                opt.value = i;
                opt.text = "" + i;
                g_day.add(opt);
                //console.log(i,opt);

            }

        });
        g_year.addEventListener("change", function () {
            var s_day_length = g_day.options.length;
            for (var k in g_day) {
                g_day.remove(g_day[k]);
            }
            d_year = g_year.value;
            d_month = g_month.value;
            var if_2_29;

            //console.log(g_year.value, g_month.value,(d_year % 4 == 0 && d_year % 100 != 0) || (d_year % 400) == 0,days_num[2]);
            if ((d_year % 4 == 0 && d_year % 100 != 0) || (d_year % 400) == 0) {
                if_2_29 = true;
                days_num[2] = 29;
                //console.log("after change",days_num[2])
            } else {
                if_2_29 = false;
                days_num[2] = 28;
            }
            var i = 1;
            //console.log("before creating",days_num[2])
            var len = days_num[d_month];
            for (i; i <= len; i++) {

                var opt = document.createElement("OPTION");
                opt.value = i;
                opt.text = "" + i;
                g_day.add(opt);
                //console.log(i,opt);
            }

        });

    }



    function minus_Date(resource) {
        //console.log("in minus_date():", resource, typeof (resource));
        var s_year = document.getElementById("year-select").value;
        var s_month = document.getElementById("month-select").value;
        var s_day = document.getElementById("day-select").value;
        var s_hour = document.getElementById("hour-select").value;
        var s_minite = document.getElementById("minite-select").value;
        var s_second = document.getElementById("second-select").value;
        var p_result = document.getElementById("result-wrapper");
        //console.log("in minus_date(),detail", s_year, s_month, s_day, s_hour, s_minite, s_second);
        var head = "现在距离：";
        var s_date = s_year + "年" + s_month + "月" + s_day + "日" + s_hour + ":" + s_minite + ":" + s_second;
        //console.log("in minus date(),string build",head,s_date)
        var from = resource;
        var now_a_days = from.slice(0,4)+"年"+from.slice(4,6)+"月"+from.slice(6,8)+"日 | "+from.slice(8,10)+":"+from.slice(10,12)+":"+from.slice(12,14);
        var to = s_year + fnW(s_month) + fnW(s_day) + s_hour + s_minite + s_second;

        if (parseInt(from) - parseInt(to) > 0) {
            head = "现在"+now_a_days+"<br>距离 \"所选时间\" " + s_date + "已经过去";

        } else {
            head = "现在"+now_a_days+"<br>距离 \"所选时间\"" + s_date + " 还有";
        }
        var minus_year = Math.abs(parseInt(from.slice(0, 4)) - parseInt(to.slice(0, 4)));
        var minus_month = Math.abs(parseInt(from.slice(4, 6)) - parseInt(to.slice(4, 6)));
        var minus_day = Math.abs(parseInt(from.slice(6, 8)) - parseInt(to.slice(6, 8)));
        var minus_hour = Math.abs(parseInt(from.slice(8, 10)) - parseInt(to.slice(8, 10)));
        var minus_minute = Math.abs(parseInt(from.slice(10, 12)) - parseInt(to.slice(10, 12)));
        var minus_second = Math.abs(parseInt(from.slice(12, 14)) - parseInt(to.slice(12, 14)));
        
        /*var from_hour =parseInt(from.slice(8, 10));
        var from_minute =parseInt(from.slice(10, 12));
        var from_second =parseInt(from.slice(12, 14));
        var to_hour=parseInt(to.slice(8, 10));
        var to_minute=parseInt(to.slice(10, 12));
        var to_second=parseInt(to.slice(12, 14));
        var from_total = from_hour*24*60 + from_minute*60+from_second;
        var to_total = to_hour*24*60 + to_minute*60 + to_second;
        var subtract = Math.abs(from_total-to_total);
        var sh =Math.floor(subtract/24/60);
        var sm = Math.floor((subtract/24/60 - sh)*60);
        var ss = subtract - sh*24*60 - sm*60;
        */
        //console.log("from:"+from_total,"to:"+to_total,"sh:"+sh,"sm:"+sm,"ss:"+ss,"result:"+subtract)
        //console.log("got nimus year", minus_year,minus_month,minus_day,minus_hour,minus_minute,minus_second);
        //console.log("in minus date(),from & to:", parseInt(from), parseInt(to), head);
        var end = "<br> | "+minus_year+"年"+minus_month+"月"+minus_day+"日"+" | "+minus_hour+":"+minus_minute+":"+minus_second;
        p_result.innerHTML = head+end;
    }
    //js 获取当前时间
    function fnDate() {
        //dom select

        //
        var date = new Date();
        var year = date.getFullYear(); //当前年份
        var month = fnW(date.getMonth() + 1); //当前月份
        var exactday = fnW(date.getDate()); //天
        var day = date.getDay(); //星期几

        var hours = fnW(date.getHours()); //小时
        var minute = fnW(date.getMinutes()); //分
        var second = fnW(date.getSeconds()); //秒
        var whole = {
            year: year,
            month: month,
            exactday: exactday,
            day: return_day(day),
            hours: hours,
            minute: minute,
            second: second
        }
        var whole2 = {
            year: year,
            month: month,
            exactday: exactday,
            day: return_day2(day),
            hours: hours,
            minute: minute,
            second: second
        }
        var result = year + month + exactday + hours + minute + second;

        var time = formatter(whole);
        var time2 = formatter2(whole2)
        document.getElementById("date").innerHTML = time;
        document.getElementById("date2").innerHTML = time2;
        //console.log("in fnDate,we return",result)
        return result;
    }
    //formatter 
    function formatter(n) {
        var result;


        //console.log("day:"+n.day,"year:"+n.year,"month:"+n.month,"hours:"+n.hours)

        result = "| " + n.year + "年" + n.month + "月" + n.exactday + "天 | " + n.day + " " + n.hours + ":" + n.minute +
            ":" + n.second;
        return result;

    }
    //formatter 2
    function formatter2(n) {
        var result;

        //console.log(n.hours,typeof(n.hours),parseInt(n.hours),typeof(parseInt(n.hours)))
        //console.log("day:"+n.day,"year:"+n.year,"month:"+n.month,"hours:"+n.hours)
        var check = parseInt(n.hours);
        var noon;
        if (check <= 12) {
            noon = "AM";
        } else {
            noon = "PM";
        }
        result = "| " + n.year + "年" + n.month + "月" + n.exactday + "天 | " + n.day + " " + n.hours + ":" + n.minute +
            ":" + n.second + " " + noon;
        return result;

    }
    //星期几
    function return_day(n) {
        //console.log("typeof,",typeof(n))
        var result = "";
        switch (n) {
            case 1:
                result = "星期一";
                break;
            case 2:
                result = "星期二";
                break;
            case 3:
                result = "星期三";
                break;
            case 4:
                result = "星期四";
                break;
            case 5:
                result = "星期五";
                break;
            case 6:
                result = "星期六";
                break;
            case 7:
                result = "星期七";
                break;

        }
        return result;
    }
    //英文星期几
    function return_day2(n) {
        //console.log("typeof,",typeof(n))
        var result = "";
        switch (n) {
            case 1:
                result = "Monday";
                break;
            case 2:
                result = "Tuesday";
                break;
            case 3:
                result = "Wenesday";
                break;
            case 4:
                result = "Thursday";
                break;
            case 5:
                result = "Friday";
                break;
            case 6:
                result = "Saturday";
                break;
            case 7:
                result = "Sunday";
                break;

        }
        return result;
    }
    //补位 当某个字段不是两位数时补0
    function fnW(str) {
        var num;
        str > 10 ? num = str : num = "0" + str;
        return num;
    }
    //返回
    //first mission: to make a stable function GoStep(n) using Go()
    //function area
    function Go() {
        console.log("Go")
    }

    function isNumeric(n) {
        return !isNaN(parseFloat(n)) && isFinite(n);
    }

    function GoSteps(n) {
        var exact = 0;
        if (isNumeric(n) && n > 0) {

            exact = parseInt(Math.floor(n));
            //console.log(n,typeof(n),exact)
        } else if (typeof (n) == "boolean") {

            if (n == true) {
                exact = 1;
            } else {
                exact = 0;
            }
            //console.log("boolean type",exact)
        } else if (typeof (n) == "undefined") {
            exact = 1;
            //console.log("here undefined",n,typeof(n),exact)
        } else {
            exact = 0;
            //console.log("not a number",n,typeof(n),exact)
            console.log("GoSteps(" + n + ")", "can't Go()")
        }

        var i = 0;
        for (i; i < exact; i++) {
            console.log("GoSteps(" + n + ")", i + 1);
            Go();
        }
    }
    GoSteps(10); // Go 10次
    GoSteps(1); // Go 1次
    GoSteps(); // Go 1次，认为缺少参数时，默认参数为1
    GoSteps(0); // 0次
    GoSteps(-1); // 0次
    GoSteps(1.4); // Go 1次
    GoSteps(1.6); // Go 1次
    GoSteps(-1); // 0次
    GoSteps(true); // Go 1次
    GoSteps(false); // 0次
    GoSteps("Test"); // 0次
    GoSteps(NaN); // 0次
    GoSteps(null); // 0次
</script>

</html>